<div class="lang-toggle" data-lang-toggle style="text-align:right;margin:1rem 0;padding:10px;background:#f8f9fa;border-radius:8px;">
  <button type="button" id="lang-en" data-lang-btn data-lang="en" class="lang-btn" aria-pressed="false">ğŸ‡¬ğŸ‡§ English</button>
  <span style="color:#ccc;margin:0 5px;">|</span>
  <button type="button" id="lang-hi" data-lang-btn data-lang="hi" class="lang-btn" aria-pressed="false">ğŸ‡®ğŸ‡³ à¤¹à¤¿à¤¨à¥à¤¦à¥€</button>
</div>

<style>
.lang-btn {
  padding: 8px 16px;
  background: #fff;
  border: 2px solid #e0e0e0;
  border-radius: 6px;
  cursor: pointer;
  font-weight: 600;
  font-size: 14px;
  transition: all 0.3s ease;
}
.lang-btn:hover {
  background: #e8f0fe;
  border-color: #1a73e8;
}
.lang-btn.active {
  background: #1a73e8;
  color: white;
  border-color: #1a73e8;
}
.lang-section {
  animation: fadeIn 0.3s ease-in;
}
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}
</style>

<script>
(function () {
  const toggleReady = () => {
    const containers = document.querySelectorAll('[data-lang-toggle]');
    if (!containers.length) {
      return;
    }

    const sections = Array.from(document.querySelectorAll('.lang-section'));
    if (!sections.length) {
      containers.forEach((container) => {
        container.style.display = 'none';
        container.setAttribute('aria-hidden', 'true');
      });
      return;
    }

    const resolveLang = (section) => section?.dataset?.lang || section?.id || '';
    const languages = Array.from(new Set(sections.map(resolveLang).filter(Boolean)));
    if (languages.length <= 1) {
      containers.forEach((container) => {
        container.style.display = 'none';
        container.setAttribute('aria-hidden', 'true');
      });
      sections.forEach((section) => {
        section.hidden = false;
      });
      return;
    }

    const buttons = document.querySelectorAll('[data-lang-btn]');
    const setLang = (lang) => {
      let hasMatch = false;
      sections.forEach((section) => {
        const isMatch = resolveLang(section) === lang;
        section.hidden = !isMatch;
        if (isMatch) {
          hasMatch = true;
        }
      });

      if (!hasMatch) {
        sections.forEach((section) => {
          section.hidden = false;
        });
        buttons.forEach((button) => {
          button.classList.remove('active');
          button.setAttribute('aria-pressed', 'false');
        });
        return;
      }

      buttons.forEach((button) => {
        const isActive = button.dataset.lang === lang;
        button.classList.toggle('active', isActive);
        button.setAttribute('aria-pressed', String(isActive));
      });
      localStorage.setItem('prefLang', lang);
    };

    buttons.forEach((button) => {
      button.addEventListener('click', () => {
        setLang(button.dataset.lang);
      });
    });

    const savedLang = localStorage.getItem('prefLang');
    setLang(languages.includes(savedLang) ? savedLang : languages[0]);
  };

  if (document.readyState === 'complete' || document.readyState === 'interactive') {
    toggleReady();
  } else {
    document.addEventListener('DOMContentLoaded', toggleReady);
  }
})();
</script>
