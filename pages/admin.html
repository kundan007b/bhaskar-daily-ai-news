---
layout: default
title: Admin - Upload Article
permalink: /admin/
robots: noindex, nofollow
---

<div class="min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8">
  <div class="max-w-4xl mx-auto">
    
    <!-- Login Section -->
    <div id="loginSection" class="bg-white rounded-lg shadow-md p-8">
      <div class="text-center mb-8">
        <h1 class="text-3xl font-bold text-gray-900 mb-2">Admin Login</h1>
        <p class="text-gray-600">Upload articles directly to your blog</p>
      </div>
      
      <div class="max-w-md mx-auto">
        <div class="mb-4">
          <label for="userId" class="block text-sm font-medium text-gray-700 mb-2">User ID</label>
          <input type="text" id="userId" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Enter user ID">
        </div>
        
        <div class="mb-6">
          <label for="password" class="block text-sm font-medium text-gray-700 mb-2">Password</label>
          <input type="password" id="password" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Enter password">
        </div>
        
        <div id="loginError" class="hidden mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg text-sm"></div>
        
        <button onclick="login()" class="w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition">
          Login
        </button>
      </div>
    </div>

    <!-- Upload Section -->
    <div id="uploadSection" class="hidden bg-white rounded-lg shadow-md p-8">
      <div class="flex justify-between items-center mb-8">
        <h1 class="text-3xl font-bold text-gray-900">Upload New Article</h1>
        <button onclick="logout()" class="text-red-600 hover:text-red-800 font-medium">Logout</button>
      </div>
      
      <form id="articleForm" class="space-y-6">
        <!-- Title -->
        <div>
          <label for="title" class="block text-sm font-medium text-gray-700 mb-2">Article Title *</label>
          <input type="text" id="title" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Enter article title">
        </div>

        <!-- Slug -->
        <div>
          <label for="slug" class="block text-sm font-medium text-gray-700 mb-2">URL Slug *</label>
          <input type="text" id="slug" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="article-url-slug">
          <p class="mt-1 text-sm text-gray-500">Will create: YYYY-MM-DD-article-url-slug.md</p>
        </div>

        <!-- Author -->
        <div>
          <label for="author" class="block text-sm font-medium text-gray-700 mb-2">Author *</label>
          <select id="author" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
            <option value="">Select Author</option>
            <option value="rajesh-kumar">Rajesh Kumar</option>
            <option value="ananya-singh">Ananya Singh</option>
          </select>
        </div>

        <!-- Categories -->
        <div>
          <label for="categories" class="block text-sm font-medium text-gray-700 mb-2">Categories *</label>
          <div class="grid grid-cols-2 gap-3">
            <label class="flex items-center">
              <input type="checkbox" name="category" value="AI" class="mr-2">
              <span class="text-sm">AI</span>
            </label>
            <label class="flex items-center">
              <input type="checkbox" name="category" value="Startups" class="mr-2">
              <span class="text-sm">Startups</span>
            </label>
            <label class="flex items-center">
              <input type="checkbox" name="category" value="Gadgets" class="mr-2">
              <span class="text-sm">Gadgets</span>
            </label>
            <label class="flex items-center">
              <input type="checkbox" name="category" value="Cybersecurity" class="mr-2">
              <span class="text-sm">Cybersecurity</span>
            </label>
            <label class="flex items-center">
              <input type="checkbox" name="category" value="Cloud Computing" class="mr-2">
              <span class="text-sm">Cloud Computing</span>
            </label>
            <label class="flex items-center">
              <input type="checkbox" name="category" value="Technology" class="mr-2">
              <span class="text-sm">Technology</span>
            </label>
          </div>
        </div>

        <!-- Language -->
        <div>
          <label for="language" class="block text-sm font-medium text-gray-700 mb-2">Language *</label>
          <select id="language" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
            <option value="en">English</option>
            <option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä (Hindi)</option>
          </select>
        </div>

        <!-- News Keywords -->
        <div>
          <label for="keywords" class="block text-sm font-medium text-gray-700 mb-2">News Keywords</label>
          <input type="text" id="keywords" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="AI, technology, India (comma separated)">
        </div>

        <!-- Image URL -->
        <div>
          <label for="image" class="block text-sm font-medium text-gray-700 mb-2">Featured Image URL</label>
          <input type="text" id="image" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="/assets/images/posts/image.jpg">
        </div>

        <!-- Excerpt -->
        <div>
          <label for="excerpt" class="block text-sm font-medium text-gray-700 mb-2">Excerpt (Optional)</label>
          <textarea id="excerpt" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Brief summary of the article"></textarea>
        </div>

        <!-- Content -->
        <div>
          <label for="content" class="block text-sm font-medium text-gray-700 mb-2">Article Content (Markdown) *</label>
          <textarea id="content" required rows="15" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono text-sm" placeholder="Write your article content in Markdown format..."></textarea>
        </div>

        <!-- Status Messages -->
        <div id="uploadError" class="hidden p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg"></div>
        <div id="uploadSuccess" class="hidden p-4 bg-green-100 border border-green-400 text-green-700 rounded-lg"></div>

        <!-- Submit Button -->
        <div class="flex gap-4">
          <button type="submit" class="flex-1 bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition">
            üì§ Publish Article
          </button>
          <button type="button" onclick="resetForm()" class="px-6 py-3 border border-gray-300 rounded-lg font-semibold hover:bg-gray-50 transition">
            Reset
          </button>
        </div>
      </form>
    </div>

  </div>
</div>

<script>
// Authentication
function login() {
  const userId = document.getElementById('userId').value;
  const password = document.getElementById('password').value;
  const loginError = document.getElementById('loginError');
  
  // Simple client-side authentication (NOT secure for production)
  if (userId === 'kb007' && password === 'Kundan@20') {
    sessionStorage.setItem('isAuthenticated', 'true');
    document.getElementById('loginSection').classList.add('hidden');
    document.getElementById('uploadSection').classList.remove('hidden');
    loginError.classList.add('hidden');
  } else {
    loginError.textContent = 'Invalid credentials. Please try again.';
    loginError.classList.remove('hidden');
  }
}

function logout() {
  sessionStorage.removeItem('isAuthenticated');
  sessionStorage.removeItem('githubToken');
  document.getElementById('loginSection').classList.remove('hidden');
  document.getElementById('uploadSection').classList.add('hidden');
  resetForm();
}

// Check authentication on load
window.addEventListener('DOMContentLoaded', function() {
  if (sessionStorage.getItem('isAuthenticated') === 'true') {
    document.getElementById('loginSection').classList.add('hidden');
    document.getElementById('uploadSection').classList.remove('hidden');
  }
  
  // Auto-generate slug from title
  document.getElementById('title').addEventListener('input', function() {
    const slug = this.value
      .toLowerCase()
      .replace(/[^a-z0-9\s-]/g, '')
      .replace(/\s+/g, '-')
      .replace(/-+/g, '-')
      .trim();
    document.getElementById('slug').value = slug;
  });
});

// Form submission
document.getElementById('articleForm').addEventListener('submit', async function(e) {
  e.preventDefault();
  
  const uploadError = document.getElementById('uploadError');
  const uploadSuccess = document.getElementById('uploadSuccess');
  uploadError.classList.add('hidden');
  uploadSuccess.classList.add('hidden');
  
  try {
    // Get form data
    const title = document.getElementById('title').value;
    const slug = document.getElementById('slug').value;
    const author = document.getElementById('author').value;
    const language = document.getElementById('language').value;
    const keywords = document.getElementById('keywords').value;
    const image = document.getElementById('image').value;
    const excerpt = document.getElementById('excerpt').value;
    const content = document.getElementById('content').value;
    
    // Get selected categories
    const categoryCheckboxes = document.querySelectorAll('input[name="category"]:checked');
    const categories = Array.from(categoryCheckboxes).map(cb => cb.value);
    
    if (categories.length === 0) {
      throw new Error('Please select at least one category');
    }
    
    // Create date string
    const today = new Date();
    const dateStr = today.toISOString().split('T')[0];
    
    // Build front matter
    let frontMatter = '---\n';
    frontMatter += `layout: post\n`;
    frontMatter += `title: "${title}"\n`;
    frontMatter += `author: ${author}\n`;
    frontMatter += `categories: [${categories.join(', ')}]\n`;
    if (image) frontMatter += `image: ${image}\n`;
    frontMatter += `lang: ${language}\n`;
    frontMatter += `date: ${dateStr}\n`;
    if (keywords) frontMatter += `news_keywords: "${keywords}"\n`;
    if (excerpt) frontMatter += `excerpt: "${excerpt}"\n`;
    frontMatter += '---\n\n';
    
    // Combine front matter and content
    const fullContent = frontMatter + content;
    
    // Create filename
    const filename = `${dateStr}-${slug}.md`;
    
    // GitHub API upload
    await uploadToGitHub(filename, fullContent);
    
    uploadSuccess.innerHTML = `‚úÖ <strong>Article published successfully!</strong><br>Filename: ${filename}<br>GitHub Pages will rebuild in 1-2 minutes.`;
    uploadSuccess.classList.remove('hidden');
    
    // Reset form after 3 seconds
    setTimeout(() => {
      resetForm();
      uploadSuccess.classList.add('hidden');
    }, 5000);
    
  } catch (error) {
    uploadError.textContent = '‚ùå Error: ' + error.message;
    uploadError.classList.remove('hidden');
  }
});

async function uploadToGitHub(filename, content) {
  // GitHub Personal Access Token (needs to be set)
  let token = sessionStorage.getItem('githubToken');
  
  if (!token) {
    token = prompt('Enter your GitHub Personal Access Token (with repo permissions):\n\nCreate one at: https://github.com/settings/tokens\n\nPermissions needed: repo');
    if (!token) {
      throw new Error('GitHub token is required to upload articles');
    }
    sessionStorage.setItem('githubToken', token);
  }
  
  const owner = 'kundan007b';
  const repo = 'bhaskar-daily-ai-news';
  const path = `_posts/${filename}`;
  const branch = 'main';
  
  // Encode content to base64
  const encodedContent = btoa(unescape(encodeURIComponent(content)));
  
  // GitHub API endpoint
  const url = `https://api.github.com/repos/${owner}/${repo}/contents/${path}`;
  
  // Check if file already exists
  let sha = null;
  try {
    const checkResponse = await fetch(url, {
      headers: {
        'Authorization': `token ${token}`,
        'Accept': 'application/vnd.github.v3+json'
      }
    });
    
    if (checkResponse.ok) {
      const data = await checkResponse.json();
      sha = data.sha;
    }
  } catch (error) {
    // File doesn't exist, which is fine for new articles
  }
  
  // Create or update file
  const payload = {
    message: `Add article: ${filename}`,
    content: encodedContent,
    branch: branch
  };
  
  if (sha) {
    payload.sha = sha;
    payload.message = `Update article: ${filename}`;
  }
  
  const response = await fetch(url, {
    method: 'PUT',
    headers: {
      'Authorization': `token ${token}`,
      'Accept': 'application/vnd.github.v3+json',
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(payload)
  });
  
  if (!response.ok) {
    const error = await response.json();
    if (response.status === 401) {
      sessionStorage.removeItem('githubToken');
      throw new Error('Invalid GitHub token. Please try again with a valid token.');
    }
    throw new Error(error.message || 'Failed to upload to GitHub');
  }
  
  return await response.json();
}

function resetForm() {
  document.getElementById('articleForm').reset();
  const checkboxes = document.querySelectorAll('input[name="category"]');
  checkboxes.forEach(cb => cb.checked = false);
}

// Handle Enter key on login
document.getElementById('userId').addEventListener('keypress', function(e) {
  if (e.key === 'Enter') login();
});

document.getElementById('password').addEventListener('keypress', function(e) {
  if (e.key === 'Enter') login();
});
</script>

<style>
/* Additional custom styles */
#uploadSection textarea {
  resize: vertical;
  min-height: 100px;
}

input:focus, textarea:focus, select:focus {
  outline: none;
}

button:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}
</style>
