<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <title>{% if page.title %}{{ page.title | escape }} | {% endif %}{{ site.title | escape }}</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Devanagari:wght@400;600;700&display=swap" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="{{ '/assets/css/main.css' | relative_url }}">
    
    <!-- SEO -->
    {% include seo.html %}
    {%- feed_meta -%}
    <link rel="sitemap" type="application/xml" title="Sitemap" href="{{ '/sitemap.xml' | relative_url }}"/>
    
    <!-- Google Analytics -->
    {%- include analytics.html -%}
    
    <!-- AdSense -->
    {%- include adsense.html -%}
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üì∞</text></svg>">
</head>
<body>
    <!-- Header -->
    <header class="site-header">
        <div class="header-container">
            <a href="{{ '/' | relative_url }}" class="site-logo">
                <div class="logo-icon">üì∞</div>
                <span>{{ site.title }}</span>
            </a>
            
            <button class="menu-toggle" aria-label="Toggle menu" onclick="toggleMenu()">
                ‚ò∞
            </button>
            
            <nav class="site-nav" id="mainNav">
                <a href="{{ '/' | relative_url }}" class="nav-link">Home</a>
                <a href="{{ '/politics' | relative_url }}" class="nav-link">Politics</a>
                <a href="{{ '/business' | relative_url }}" class="nav-link">Business</a>
                <a href="{{ '/technology' | relative_url }}" class="nav-link">Technology</a>
                <a href="{{ '/finance' | relative_url }}" class="nav-link">Finance</a>
                <a href="{{ '/startups' | relative_url }}" class="nav-link">Startups</a>
                <a href="{{ '/search' | relative_url }}" class="nav-link">üîç Search</a>
                <a href="https://github.com/kundan007b/bhaskar-daily-ai-news/issues/new?template=new_post.yml" class="nav-link">üìù Submit</a>
                <button class="lang-toggle" onclick="toggleLanguage()">
                    <span id="lang-text">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</span>
                </button>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-container">
        {{ content }}
        
        <!-- Newsletter Signup (before footer) -->
        {% if page.layout != 'post' %}
        <div style="max-width: 600px; margin: 3rem auto;">
            {%- include newsletter-signup.html -%}
        </div>
        {% endif %}
    </main>

    <!-- Footer -->
    <footer class="site-footer">
        <div class="footer-container">
            <div class="footer-section">
                <h3>About</h3>
                <p>Bilingual news covering India's politics, business, technology, finance, and startups. Written by KB with regular updates.</p>
                <div class="social-links">
                    <a href="https://twitter.com" class="social-link" aria-label="Twitter">üê¶</a>
                    <a href="https://facebook.com" class="social-link" aria-label="Facebook">üìò</a>
                    <a href="{{ '/feed.xml' | relative_url }}" class="social-link" aria-label="RSS">üì°</a>
                </div>
            </div>
            
            <div class="footer-section">
                <h3>Categories</h3>
                <ul>
                    <li><a href="{{ '/politics' | relative_url }}">üèõÔ∏è Politics</a></li>
                    <li><a href="{{ '/business' | relative_url }}">üíº Business</a></li>
                    <li><a href="{{ '/technology' | relative_url }}">üíª Technology</a></li>
                    <li><a href="{{ '/finance' | relative_url }}">üí∞ Finance</a></li>
                    <li><a href="{{ '/startups' | relative_url }}">üöÄ Startups</a></li>
                </ul>
            </div>
            
            <div class="footer-section">
                <h3>Quick Links</h3>
                <ul>
                    <li><a href="{{ '/about' | relative_url }}">About Us</a></li>
                    <li><a href="{{ '/faq' | relative_url }}">FAQ</a></li>
                    <li><a href="{{ '/contact' | relative_url }}">Contact</a></li>
                    <li><a href="{{ '/privacy-policy' | relative_url }}">Privacy Policy</a></li>
                    <li><a href="{{ '/feed.xml' | relative_url }}">RSS Feed</a></li>
                    <li><a href="https://github.com/kundan007b/bhaskar-daily-ai-news/issues/new?template=new_post.yml">Submit a Post</a></li>
                </ul>
            </div>
            
            <div class="footer-section">
                <h3>Subscribe</h3>
                <p>Get news updates delivered to your inbox.</p>
                <form id="footer-subscribe-form" style="margin-top: 1rem;">
                    <input type="email" id="footer-email" placeholder="Your email" required style="padding: 0.5rem; border-radius: 4px; border: 1px solid #ddd; width: 100%; margin-bottom: 0.5rem;">
                    <button type="submit" class="btn btn-primary" style="width: 100%;">Subscribe</button>
                    <div id="footer-subscribe-message" style="margin-top: 0.5rem; padding: 0.5rem; border-radius: 4px; display: none; font-size: 0.9rem;"></div>
                </form>
            </div>
        </div>
        
        <div class="footer-bottom">
            <p>&copy; {{ 'now' | date: "%Y" }} {{ site.title }}. All rights reserved.</p>
            <p style="margin-top: 0.5rem; font-size: 0.9rem;">Written by KB ‚Ä¢ Powered by Jekyll</p>
        </div>
    </footer>

    <!-- Scripts -->
    <script>
        function toggleMenu() {
            const nav = document.getElementById('mainNav');
            nav.classList.toggle('active');
        }
        
        let currentLang = 'en';
        function toggleLanguage() {
            const langText = document.getElementById('lang-text');
            if (currentLang === 'en') {
                currentLang = 'hi';
                langText.textContent = 'English';
            } else {
                currentLang = 'en';
                langText.textContent = '‡§π‡§ø‡§®‡•ç‡§¶‡•Ä';
            }
        }
        
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        });

        // Email subscription handler
        function handleSubscription(emailInputId, messageElementId) {
            const email = document.getElementById(emailInputId).value;
            const messageDiv = document.getElementById(messageElementId);
            const submitBtn = event.target.querySelector('button[type="submit"]');
            
            // Simple email validation
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                showMessage(messageDiv, '‚ùå Please enter a valid email address', 'error');
                return;
            }
            
            // Disable button during submission
            const originalText = submitBtn.textContent;
            submitBtn.disabled = true;
            submitBtn.textContent = 'Subscribing...';
            
            // Send via EmailJS
            emailjs.send('service_dg7ejnn', 'template_xava7jp', {
                to_email: email,
                subscriber_email: email,
                site_name: '{{ site.title }}',
                site_url: '{{ site.url }}',
                date: new Date().toLocaleDateString()
            })
            .then(function(response) {
                console.log('SUCCESS!', response.status, response.text);
                showMessage(messageDiv, '‚úÖ Success! Check your email for confirmation.', 'success');
                document.getElementById(emailInputId).value = '';
                
                // Store subscriber in GitHub via API
                storeSubscriber(email);
            }, function(error) {
                console.log('FAILED...', error);
                showMessage(messageDiv, '‚ùå Subscription failed. Please try again.', 'error');
            })
            .finally(function() {
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
            });
        }
        
        function showMessage(element, message, type) {
            element.style.display = 'block';
            element.textContent = message;
            
            if (type === 'success') {
                element.style.background = 'rgba(52, 168, 83, 0.9)';
                element.style.color = 'white';
            } else {
                element.style.background = 'rgba(234, 67, 53, 0.9)';
                element.style.color = 'white';
            }
            
            setTimeout(function() {
                element.style.display = 'none';
            }, 5000);
        }
        
        function storeSubscriber(email) {
            // Store in GitHub repo via API (optional - for your records)
            const repoOwner = 'kundan007b';
            const repoName = 'bhaskar-daily-ai-news';
            const issueTitle = 'New Subscriber: ' + email;
            const issueBody = '<!-- form: subscribe -->\n\n**Email:** ' + email + '\n**Date:** ' + new Date().toISOString();
            
            fetch('https://api.github.com/repos/' + repoOwner + '/' + repoName + '/issues', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    title: issueTitle,
                    body: issueBody,
                    labels: ['subscribe']
                })
            }).catch(function(error) {
                console.log('GitHub storage failed (non-critical):', error);
            });
        }
        
        // Footer subscribe form handler
        if (document.getElementById('footer-subscribe-form')) {
            document.getElementById('footer-subscribe-form').addEventListener('submit', function(e) {
                e.preventDefault();
                handleSubscription('footer-email', 'footer-subscribe-message');
            });
        }
    </script>
    
    <!-- EmailJS SDK -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script type="text/javascript">
        (function(){
            emailjs.init("k1oKk9CNKGs_h7FW5");
        })();
    </script>
</body>
</html>

